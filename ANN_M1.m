function [y1] = ANN_M1(x1)
%ANN_10_10_TT_MAT neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 27-Oct-2023 20:41:49.
% 
% [y1] = ANN_10_10_tt_mat(x1) takes these arguments:
%   x = 4xQ matrix, input #1
% and returns:
%   y = 3xQ matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [4.000735114;4000.49418;500.5685276;0.700044945];
x1_step1.gain = [0.181868602970468;0.00050007367047808;0.000571688638405072;6.66834706789995];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.1043643148502231277;0.94982663142842482795;-0.47930655999024207592;-0.41768534683113545114;-0.56597790252411039891;-0.7603292672391787077;2.1799467000092902502;-1.6544503083778481223;0.1465902346272904555;-1.7610286111471082915];
IW1_1 = [-0.013635643093015637969 -0.0098333568869913325072 -1.006759791219043132 0.064214889309817640983;0.020695703379485785867 -0.031591789253627225453 -0.41680798880129449335 -0.062738705564537269876;0.08703619675269134992 0.028746604322835319495 0.06164797854395568516 0.19240262159089227545;0.00025442697513876181854 -0.12013183642972016796 -0.48919798126113550607 0.078907430903453035231;-0.00033371568405353310921 -0.0016590159960691284492 0.12874046374763620237 -0.00012980245040148286235;-0.0035352586602496387062 -0.014959911059610350725 0.36060268293192260236 -0.0078780092766590412157;0.55534927513247334119 -0.014459123885182325817 -0.20903400810458286352 -0.02658703500287579527;-0.00015065318945802359243 -0.47859357237015054398 0.22598504385120840587 0.13110389784518972078;0.0016763501069795429081 0.068750678409279619707 -0.043069392437198948664 -0.079415095445598923862;-0.004116429209945410457 -0.013276338892923289503 -0.71674272145409057 0.0010154973717705865089];

% Layer 2
b2 = [-0.20280676399995059556;5.4097095737785370062;19.052793442021386028;0.840655718955374609;-0.60082029031715800116;-2.3595365544545225944;-0.99369644756925512574;0.84872933188202426269;5.4249097347455155216;-2.707576197694866238];
LW2_1 = [1.3085040038640305404 -0.67560682536304872414 1.2139303499810958353 0.57841022107662776186 -0.40930468520750096229 1.3061072933223267789 1.318209814349322162 -0.77479926593640380261 2.7315604352970184188 -0.37019008204301684373;-0.81694180039240260616 -2.8182277901813361787 1.6878364319049656839 4.460980592913777798 0.36900123083441593863 -1.3594184517578802307 -1.6546134748610361598 -1.1059576721105939257 1.3470477331708798907 0.042688719323907442504;-1.4262959729152810961 2.7937269617107896025 -1.204182763305557291 -1.0060000643640703011 1.2951971059083682292 0.69651607096950629572 2.1825518986226213336 24.127256475977745254 -2.8552229701669578077 3.2085008580325400374;-1.1239116989853574768 -1.0470838960871162726 0.0081795930227158177017 -0.23729132046229584052 -1.0393587739158594019 -1.3205917565053237883 0.098722969923120490465 -0.13101002693786431563 -0.51296168336125635978 2.4641514127999797346;0.58508679846709987782 0.88846571133322727043 0.75694249505103838871 0.36225187227222288566 -3.3127481075949991585 -0.59587189695444076065 -0.82687741131243874815 0.776238283160230913 1.515668626452526313 -0.12912739100301845463;-0.014829296199397124303 -0.37770797971892533518 0.38766390771491499034 -0.011520319516233721788 1.1704469442280391878 0.19949981445455761131 0.30752822061373658036 -0.38179356163120314882 0.44977663630071407219 -2.0953739197291652019;0.021508925028946780655 0.03716138974985312704 -0.033403195231695430312 0.0024869102916365280233 -2.3775799966195436674 0.32489130470094623737 -0.022995258893659772242 0.030440318644716635177 -0.022792287490195177468 0.072386284541134632287;0.064913519283488055334 0.10160703046700134133 -0.072634090033102435835 -0.00356834381700562751 3.0499765315966320678 -0.21588430367101110741 -0.03193655973181060842 0.060200734624280174967 -0.036322525361879284822 -0.27645525351484706578;1.7557929519654491557 0.80680757730991403687 2.2870192728348364142 1.5871904451649823109 -0.58367558796612251104 -0.28657302762397407481 -2.3931906585229905104 -1.1535851795734561875 -2.5240882624732838835 -0.24108900936358787503;0.14978133105248508938 -1.1764511528261623052 -0.49567113717693533914 -0.19678725030543747776 -2.0766837697927358342 -0.8729739896820055689 -1.9189719584850422063 0.15596395336451848723 -1.198632484509361662 -3.2890559691396918929];

% Layer 3
b3 = [0.27824056428103055572;-0.40812330984144701285;0.66507974484983112262];
LW3_2 = [-0.24112780918278367559 -0.074749867468709318974 0.0010345352741797885204 2.3593751910394078486 -0.17258920462175819655 2.8706103097179416217 -3.0045237058431206734 -0.72083396208107053393 0.10325693658636765637 0.29105962867870632804;0.10228707741747423976 -0.025541948239364235113 -0.00023828741896841749916 3.2236090632428826552 0.19455994769827567037 -1.1839837720977832713 -4.179315931045738175 3.9004284248666589718 0.028458910397491467281 1.2293265638962802555;-0.01091079536771540244 0.024847306383776156247 -0.00011808439929452823084 -1.5617191320916226083 -0.015143968921712953196 0.047981901120706389741 -1.9652821165337610587 1.5684641985845841905 -0.035674086331694263019 -0.45493522206778930217];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.00370077030230986;0.00220582479954177;0.00074550547483388];
y1_step1.xoffset = [39.89996257;82.06342849;310.1273125];

% ===== SIMULATION ========

% Dimensions
Q = size(x1,2); % samples

% Input 1
xp1 = mapminmax_apply(x1,x1_step1);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);

% Layer 3
a3 = repmat(b3,1,Q) + LW3_2*a2;

% Output 1
y1 = mapminmax_reverse(a3,y1_step1);
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
